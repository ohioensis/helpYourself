# Адаптивность графики

Определение ретина-экрана

```
@media (min-resolution: 144dpi),
		(min-resolution: 1.5dppx) {...}
```

## Типы контента и ретина

- Текст. С текстом проблем нет. Если что-то можно сверстать текстом, лучше это сверстать текстом. НО! Если много нестандартных шрифтов для небольших элементов (особенно декоративных), то лучше их вставлять как SVG или PNG

Если можно использовать градиенты — лучше использовать градиенты.

- Растровая графика (PNG, JPG, GIF и другие)

	**Вариант 1**: отдавать картинку для растрового фона в два раза больше. Но это плохо: все устройства загружают "тяжелый" файл.

	**Вариант 2**: использовать медиавыражения и отдавать картинку в два раза больше для экранов с высоким разрешением:

	```
	.bg-single {
		width: 200px;
		background-repeat: no-repeat;
		background-image: url("bg-200px.png"); // картинка с обычным разрешением
		background-size: 200px auto;

	@media (min-resolution: 144dpi),
		(min-resolution: 1.5dppx) {
			.bg-single {
				background-image: url("bg-400px.png");
			}
		}
	}
	```

	Важно, что размер фона при этом одинаковый, а плотность пикселей у ретины будет выше.

	Если фон повторяющийся, то действует то же правило: берется повторяющийся фрагмент в два раза больше.

	```
	.bg-pattern {
		background-repeat: repeat;
		background-image: url("bg-pattern.png");
		background-size: 25px 25px;
	}

	@media (min-resolution: 144dpi),
		(min-resolution: 1.5dppx) {
			.bg-pattern {
				background-image: url("bg-pattern-x2.png");
			}
		}
	```

	Для параметра медиавыражения удобно задать переменную в препроцессоре, например, такую:

	```
	@retina: ~"(min-resolution: 144dpi), (min-resolution: 1.5dppx)";
	```

- Растровые `<img>`
	
	**Вариант 1**: прием с увеличенной картинкой.

	```
	<img src="800px.png" width="400">
	```
	Но это вариант так себе, так как все устройства загружают большую картинку.

	Не работает даже если написать два тега `<img>` с разными классами через `display: none;` и медиавыражение: потому что загрузятся обе картинки, так делает "браузерная фея" и "эльфы-помощники", загружающие изображения в браузере на стадии HTML.

	**Вариант 2**: использование атрибута `srcset` и тега `<picture>`.

	Тег `<picture>` в сочетании с новыми атрибутами определяет умные настройки, подменяя `src` у `<img>`, когда это необходимо. Он дает возможность разработчику передать браузеру информацию, необходимую для выбора подходящей картинки.

	```
	<img
		width="300"
		src="a.png"
		srcset="a.png 300w,
				b.png 600w,
				c.png 900w"
	>
	```
	w - это количество пикселей px

	Решение, какой файл выбрать, принимает браузер в зависимости от своих "знаний" о ретиновости, скорости интернета, типе устройства и т.п.

	**Важно!** Атрибут `srcset` не предназначен для кадрирования — это должна быть **одна и та же картинка** разного качества.

	Кадрирование через тег `<picture>` возможно:

	```
	<picture>
		<source media="(min-width:960px)" srcset="a.png">
		<source media="(min-width:640px)" srcset="b.png">
		<img src="c.png">
	</picture>
	```

	Кадрирование и ретиновость можно комбинировать:

	```
	<picture>
		<source media="(min-width:960px)" 
				srcset="a1.png 1x,
						a2.png 2x">
		<img src="b.png"
			srcset="b2.png 2x"
	</picture>
	```

	Форматы изображений браузер тоже может выбирать:

	```
	<picture>
		<source type="image/webp" srcset="pic.webp">
		<source type="image/vnd.ms-photo" srcset="pic.jpxr">
		<img src="pic.jpg">
	</picture>
	```

	**Важно!** Помнить, что речь идет всего лишь об одной картинке, и не переусложнять код (только самые важные параметры).

- Векторная графика — описывается математическими формулами, размер не важен. В вебе — SVG.

Иконочные шрифты вообще лучше не использовать. Нет полного контроля за их нормальным отображением

- Фавиконки и тачиконки

Как минимум подготовить ```favicon.ico``` с иконками двух размеров, 16х16 и 32х32. Для этого можно использовать [онлайн-инструмент](http://www.xiconeditor.com/).

Есть много тонкостей с тач-иконками. Подробности — [в статье](https://mathiasbynens.be/notes/touch-icons).

[Сервис](http://realfavicongenerator.net/) для генерации фавиконок.


## Утилиты для оптимизации растровых изображений

- ImageOptim

- ImageAlpha — дополнительная оптимизация полупрозрачных PNG

**Тестировать** ретину можно в Developers Tools (рядом с вкладкой Elements картиночка планшета и телефона Toggle Device Toolbar, можно выбрать разные девайсы)

## Резиновые изображения

Спасает от переполнения следующий код:

```
img {
	max-width: 100%;
	height: auto;
}
```
Если контейнер меньше картинки, она ужимается, а если больше — сохраняет свой максимальный размер.

Для резиновых картинок используется атрибут `sizes` (когда нет атрибута `width`):

```
<img src="400.png"
	srcset="400.png 400w,
			800.png 800w,
			1200.png 1200w"
	sizes="(min-width: 600px) 50vw : 100vw"
>
```

Расшифровывается как "если ширина вьюпорта больше 600px, то картинка будет 50% вьюпорта, иначе — 100%"




